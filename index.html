<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Game Hub</title>
<style>
body { font-family: Arial, sans-serif; background: #faf8ef; margin:0; padding:0; display:flex; flex-direction:column; align-items:center;}
header { text-align:center; margin:10px;}
#game-container { background:#bbada0; border-radius:10px; padding:15px; display:inline-block; position: relative; touch-action:none; width: 350px; height: 350px;}
.tile {
    display:flex; justify-content:center; align-items:center; font-size:24px; font-weight:bold; border-radius:5px;
    transition: transform 0.2s, background 0.2s;
    position: absolute; width: calc(25% - 10px); height: calc(25% - 10px);
}
.tile.merge { animation: pop 0.15s ease; }
.tile.new { animation: spawn 0.15s ease; }

@keyframes pop { 0% { transform: scale(1) } 50% { transform: scale(1.3) } 100% { transform: scale(1) } }
@keyframes spawn { 0% { transform: scale(0) } 100% { transform: scale(1) } }

.score { font-size:20px; margin-bottom:10px;}
button { background:#8f7a66; color:white; border:none; padding:8px 12px; border-radius:5px; cursor:pointer;}
button:hover { background:#7f6a56; }
select { padding:5px; margin-bottom:10px; }
</style>
</head>
<body>

<header>
    <h1>Multi-Game Hub</h1>
    <label for="game-select">Choose a game: </label>
    <select id="game-select">
        <option value="2048">2048</option>
        <option value="snake">Snake</option>
    </select>
    <div class="score" id="score-container">Score: <span id="score">0</span></div>
    <button onclick="startGame()">Restart</button>
</header>

<div id="game-container"></div>

<script>
const gameSelect = document.getElementById('game-select');
let currentGame = '2048';
let score = 0;
let size = 4;
let grid = [];
let snake, direction, food, snakeInterval;

gameSelect.addEventListener('change', () => { currentGame = gameSelect.value; startGame(); });

function startGame() {
    score = 0;
    updateScore();
    if(currentGame === '2048') init2048();
    else if(currentGame === 'snake') initSnake();
}

/* ------------- 2048 ------------- */
function init2048() {
    grid=[]; const container = document.getElementById('game-container'); container.innerHTML='';
    for(let i=0;i<size;i++){ grid[i]=[]; for(let j=0;j<size;j++) grid[i][j]=0; }
    addRandomTile(true);
    addRandomTile(true);
    drawGrid();
}

function addRandomTile(isNew=false) {
    let empty=[]; for(let i=0;i<size;i++){ for(let j=0;j<size;j++){ if(grid[i][j]===0) empty.push({x:i,y:j}); } }
    if(empty.length===0) return;
    let {x,y} = empty[Math.floor(Math.random()*empty.length)];
    grid[x][y] = Math.random()<0.9?2:4;
    grid[x][y].isNew = isNew; // mark for spawn animation
}

function drawGrid() {
    if(currentGame!=='2048') return;
    const container=document.getElementById('game-container'); container.innerHTML='';
    for(let i=0;i<size;i++){
        for(let j=0;j<size;j++){
            if(grid[i][j]!==0){
                let tile = document.createElement('div'); tile.className='tile';
                tile.textContent=grid[i][j];
                tile.style.background=getTileColor(grid[i][j]);
                tile.style.color=grid[i][j]>4?'#f9f6f2':'#776e65';
                tile.style.transform=`translate(${j*25}%, ${i*25}%)`;
                if(grid[i][j].merged) tile.classList.add('merge');
                if(grid[i][j].isNew) tile.classList.add('new');
                container.appendChild(tile);
            }
        }
    }
}

function getTileColor(value){
    const colors={2:"#eee4da",4:"#ede0c8",8:"#f2b179",16:"#f59563",32:"#f67c5f",64:"#f65e3b",128:"#edcf72",256:"#edcc61",512:"#edc850",1024:"#edc53f",2048:"#edc22e"};
    return colors[value] || "#3c3a32";
}

function slide(row){
    row = row.filter(v=>v); let merged=[];
    for(let i=0;i<row.length-1;i++){
        if(row[i] && row[i]===row[i+1]){
            row[i]*=2; score+=row[i]; row[i+1]=0; merged.push(i);
        }
    }
    row=row.filter(v=>v); while(row.length<size) row.push(0);
    row.mergedIndexes=merged; return row;
}

function moveLeft(){ for(let i=0;i<size;i++){ let old=grid[i].slice(); grid[i]=slide(grid[i]); grid[i].forEach((v,j)=>{ if(grid[i].mergedIndexes && grid[i].mergedIndexes.includes(j)) grid[i][j]={value:v, merged:true}; else grid[i][j]={value:v}; }); } }
function moveRight(){ for(let i=0;i<size;i++){ grid[i].reverse(); let old=grid[i].slice(); grid[i]=slide(grid[i]); grid[i].reverse(); grid[i].forEach((v,j)=>{ if(grid[i].mergedIndexes && grid[i].mergedIndexes.includes(j)) grid[i][j]={value:v, merged:true}; else grid[i][j]={value:v}; }); } }
function moveUp(){ for(let j=0;j<size;j++){ let col=[]; for(let i=0;i<size;i++) col.push(grid[i][j].value || grid[i][j]); col=slide(col); for(let i=0;i<size;i++) grid[i][j]=col[i]; } }
function moveDown(){ for(let j=0;j<size;j++){ let col=[]; for(let i=0;i<size;i++) col.push(grid[i][j].value || grid[i][j]); col.reverse(); col=slide(col); col.reverse(); for(let i=0;i<size;i++) grid[i][j]=col[i]; } }

document.addEventListener('keydown', handleKey);

function handleKey(e){
    if(currentGame==='2048'){
        let oldGrid = JSON.stringify(grid.map(r=>r.map(c=>c.value||c)));
        if(e.key==='ArrowLeft') moveLeft();
        else if(e.key==='ArrowRight') moveRight();
        else if(e.key==='ArrowUp') moveUp();
        else if(e.key==='ArrowDown') moveDown();
        let newGrid = JSON.stringify(grid.map(r=>r.map(c=>c.value||c)));
        if(oldGrid!==newGrid) addRandomTile(true);
        drawGrid();
        updateScore();
    }
    else if(currentGame==='snake'){ handleSnakeKey(e); }
}

function updateScore(){ document.getElementById('score').textContent=score; }

/* ------------- Snake ------------- */
function initSnake(){
    clearInterval(snakeInterval);
    const container = document.getElementById('game-container'); container.innerHTML='';
    const cellSize = container.clientWidth/20;
    snake=[{x:10,y:10}]; direction={x:0,y:-1};
    food={x:Math.floor(Math.random()*20),y:Math.floor(Math.random()*20)};
    score=0; updateScore();
    snakeInterval=setInterval(moveSnake,100);
    drawSnake();
}

function drawSnake(){
    const container = document.getElementById('game-container'); container.innerHTML='';
    const cellSize = container.clientWidth/20;
    // food
    const foodEl=document.createElement('div'); foodEl.style.width=foodEl.style.height=cellSize+'px';
    foodEl.style.background='red'; foodEl.style.position='absolute';
    foodEl.style.left=food.x*cellSize+'px'; foodEl.style.top=food.y*cellSize+'px';
    container.appendChild(foodEl);
    // snake
    snake.forEach(s=>{ const el=document.createElement('div'); el.style.width=el.style.height=cellSize+'px'; el.style.background='green';
        el.style.position='absolute'; el.style.left=s.x*cellSize+'px'; el.style.top=s.y*cellSize+'px'; container.appendChild(el);
    });
}

function moveSnake(){
    const head={x:snake[0].x+direction.x, y:snake[0].y+direction.y};
    if(head.x<0||head.x>=20||head.y<0||head.y>=20||snake.some(s=>s.x===head.x&&s.y===head.y)){ clearInterval(snakeInterval); alert('Game Over!'); return; }
    snake.unshift(head);
    if(head.x===food.x && head.y===food.y){ score+=10; updateScore(); food={x:Math.floor(Math.random()*20),y:Math.floor(Math.random()*20)}; }
    else snake.pop();
    drawSnake();
}

function handleSnakeKey(e){
    if(e.key==='ArrowUp' && direction.y!==1) direction={x:0,y:-1};
    else if(e.key==='ArrowDown' && direction.y!==-1) direction={x:0,y:1};
    else if(e.key==='ArrowLeft' && direction.x!==1) direction={x:-1,y:0};
    else if(e.key==='ArrowRight' && direction.x!==-1) direction={x:1,y:0};
}

startGame();
</script>

</body>
</html>
